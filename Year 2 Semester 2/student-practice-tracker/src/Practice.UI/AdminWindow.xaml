<Window x:Class="Practice.Windows.AdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Admin Dashboard" Height="850" Width="1300"
        WindowStartupLocation="CenterScreen" Background="White">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Margin="20,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal">
                <Border Background="{StaticResource PrimaryColor}" Width="40" Height="40" CornerRadius="8">
                    <TextBlock Text="A" Foreground="White" FontWeight="Bold" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <StackPanel VerticalAlignment="Center" Margin="10,0,0,0">
                    <TextBlock Text="АДМІНІСТРАТОР" FontWeight="Bold" FontSize="16" Foreground="{StaticResource TextPrimary}"/>
                    <TextBlock Text="Система управління" FontSize="12" Foreground="{StaticResource TextSecondary}"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <TextBlock x:Name="TxtAdminName" Text="Admin" VerticalAlignment="Center" Margin="0,0,15,0" FontWeight="SemiBold"/>
                <Border Width="40" Height="40" CornerRadius="20" Background="{StaticResource PrimaryColor}" Margin="0,0,15,0">
                    <TextBlock x:Name="TxtInitials" Text="AD" Foreground="White" FontWeight="Bold" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <Button Content="Вийти" Click="BtnLogout_Click" Background="#FFEBEE" Foreground="#D32F2F" Height="35"/>
            </StackPanel>
        </Grid>

        <TabControl Grid.Row="1" Margin="10,0,10,10" BorderThickness="0">

            <TabItem Header="Студенти">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border BorderBrush="#EEE" BorderThickness="0,0,1,0" Padding="0,0,20,0">
                        <ScrollViewer>
                            <StackPanel>
                                <TextBlock Text="Додати студента" FontSize="18" FontWeight="Bold" Margin="0,0,0,20" Foreground="{StaticResource PrimaryColor}"/>
                                <TextBlock Text="Прізвище" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtStudLast" Margin="0,0,0,10"/>
                                <TextBlock Text="Ім'я" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtStudFirst" Margin="0,0,0,10"/>
                                <TextBlock Text="Email" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtStudEmail" Margin="0,0,0,10"/>
                                <TextBlock Text="Пароль" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtStudPass" Margin="0,0,0,10"/>
                                <TextBlock Text="Група" Style="{StaticResource LabelStyle}"/>
                                <ComboBox x:Name="CmbStudGroup" DisplayMemberPath="GroupCode" SelectedValuePath="GroupId" Margin="0,0,0,10"/>
                                <TextBlock Text="Залікова книжка" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtStudRecord" Margin="0,0,0,20"/>
                                <Button Content="Зберегти студента" Click="BtnAddStudent_Click"/>
                                <Separator Margin="0,20"/>
                                <Button Content="Масовий імпорт..." Background="#4CAF50" Click="BtnToggleImport_Click"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>

                    <Grid Grid.Column="1" Margin="20,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="Фільтр:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="CmbFilterGroup" Width="150" DisplayMemberPath="GroupCode" SelectedValuePath="GroupId" SelectionChanged="CmbFilterGroup_SelectionChanged"/>
                            <Button Content="Очистити" Click="BtnResetStudentFilter_Click" Background="#90A4AE" Margin="10,0,0,0" Padding="10,5"/>
                        </StackPanel>

                        <Border x:Name="PanelImport" Grid.Row="1" Background="#F1F8E9" Padding="15" Margin="0,0,0,15" Visibility="Collapsed" CornerRadius="4">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="300"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Margin="0,0,20,0">
                                    <TextBlock Text="Імпорт списком" FontWeight="Bold" Margin="0,0,0,10"/>
                                    <TextBlock Text="Група:" Style="{StaticResource LabelStyle}"/>
                                    <ComboBox x:Name="CmbImportGroup" DisplayMemberPath="GroupCode" SelectedValuePath="GroupId" Margin="0,0,0,10"/>
                                    <TextBlock Text="Домен (@example.com):" Style="{StaticResource LabelStyle}"/>
                                    <TextBox x:Name="TxtImportDomain" Text="@student.university.edu" Margin="0,0,0,10"/>
                                    <TextBlock Text="Список (Прізвище Ім'я):" Style="{StaticResource LabelStyle}"/>
                                    <TextBox x:Name="TxtRawNames" Height="100" AcceptsReturn="True" TextWrapping="Wrap"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                        <Button Content="Обробити" Click="BtnProcessImport_Click" Width="100"/>
                                        <Button Content="Закрити" Click="BtnCancelImport_Click" Background="Transparent" Foreground="Gray" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" Height="200">
                                        <DataGrid x:Name="GridImportPreview" AutoGenerateColumns="False" CanUserAddRows="False">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Header="Прізвище" Binding="{Binding LastName}" Width="*"/>
                                                <DataGridTextColumn Header="Ім'я" Binding="{Binding FirstName}" Width="*"/>
                                                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="*"/>
                                                <DataGridTextColumn Header="Заліковка" Binding="{Binding RecordBook}" Width="100"/>
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </ScrollViewer>
                                    <Button Grid.Row="1" Content="ЗБЕРЕГТИ ВСІХ" Click="BtnSaveImport_Click" HorizontalAlignment="Right" Margin="0,10,0,0" Width="150" Background="#4CAF50"/>
                                </Grid>
                            </Grid>
                        </Border>

                        <DataGrid Grid.Row="2" x:Name="GridAllStudents" IsReadOnly="True" CanUserSortColumns="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Прізвище" Binding="{Binding User.LastName}" Width="150"/>
                                <DataGridTextColumn Header="Ім'я" Binding="{Binding User.FirstName}" Width="150"/>
                                <DataGridTextColumn Header="Група" Binding="{Binding StudentGroup.GroupCode}" Width="100"/>
                                <DataGridTextColumn Header="Заліковка" Binding="{Binding RecordBookNumber}" Width="120"/>
                                <DataGridTextColumn Header="Email" Binding="{Binding User.Email}" Width="*"/>
                                <DataGridTemplateColumn Width="100" Header="Дії">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Style="{StaticResource IconButton}" Background="#FF9800" Click="BtnEditStudent_Click" Tag="{Binding StudentId}" Margin="0,0,5,0">
                                                    <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                </Button>
                                                <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteStudent_Click" Tag="{Binding UserId}">
                                                    <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Керівники">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border BorderBrush="#EEE" BorderThickness="0,0,1,0" Padding="0,0,20,0">
                        <ScrollViewer>
                            <StackPanel>
                                <TextBlock Text="Додати керівника" FontSize="18" FontWeight="Bold" Margin="0,0,0,20" Foreground="{StaticResource PrimaryColor}"/>
                                <TextBlock Text="Прізвище" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtSupLast" Margin="0,0,0,10"/>
                                <TextBlock Text="Ім'я" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtSupFirst" Margin="0,0,0,10"/>
                                <TextBlock Text="Email" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtSupEmail" Margin="0,0,0,10"/>
                                <TextBlock Text="Пароль" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtSupPass" Margin="0,0,0,10"/>
                                <TextBlock Text="Кафедра" Style="{StaticResource LabelStyle}"/>
                                <ComboBox x:Name="CmbSupDept" DisplayMemberPath="DepartmentName" SelectedValuePath="DepartmentId" Margin="0,0,0,10"/>
                                <TextBlock Text="Посада" Style="{StaticResource LabelStyle}"/>
                                <ComboBox x:Name="CmbSupPos" DisplayMemberPath="PositionName" SelectedValuePath="PositionId" Margin="0,0,0,10"/>
                                <TextBlock Text="Телефон" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtSupPhone" Margin="0,0,0,20"/>
                                <Button Content="Зберегти керівника" Click="BtnAddSupervisor_Click"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    <Grid Grid.Column="1" Margin="20,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="Фільтр:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="CmbFilterDept" Width="200" DisplayMemberPath="DepartmentName" SelectedValuePath="DepartmentId" SelectionChanged="CmbFilterDept_SelectionChanged"/>
                            <Button Content="Очистити" Click="BtnResetSupervisorFilter_Click" Background="#90A4AE" Margin="10,0,0,0" Padding="10,5"/>
                        </StackPanel>
                        <DataGrid Grid.Row="1" x:Name="GridAllSupervisors" IsReadOnly="True" CanUserSortColumns="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Прізвище" Binding="{Binding User.LastName}" Width="150"/>
                                <DataGridTextColumn Header="Ім'я" Binding="{Binding User.FirstName}" Width="150"/>
                                <DataGridTextColumn Header="Посада" Binding="{Binding Position.PositionName}" Width="150"/>
                                <DataGridTextColumn Header="Кафедра" Binding="{Binding Department.DepartmentName}" Width="*"/>
                                <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="120"/>
                                <DataGridTextColumn Header="Email" Binding="{Binding User.Email}" Width="200"/>
                                <DataGridTemplateColumn Width="100" Header="Дії">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Style="{StaticResource IconButton}" Background="#FF9800" Click="BtnEditSupervisor_Click" Tag="{Binding SupervisorId}" Margin="0,0,5,0">
                                                    <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                </Button>
                                                <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteSupervisor_Click" Tag="{Binding UserId}">
                                                    <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Структура">
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="220"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border BorderBrush="#EEE" BorderThickness="0,0,1,0" Background="#F9F9F9">
                        <StackPanel Margin="10,20">
                            <TextBlock Text="ДОВІДНИКИ" FontSize="12" Foreground="Gray" FontWeight="Bold" Margin="10,0,0,10"/>
                            <RadioButton x:Name="RbSpecialties" Content="Спеціальності" GroupName="S" Style="{StaticResource SidebarRadio}" IsChecked="True" Checked="StructMenu_Checked"/>
                            <RadioButton x:Name="RbGroups" Content="Групи" GroupName="S" Style="{StaticResource SidebarRadio}" Checked="StructMenu_Checked"/>
                            <RadioButton x:Name="RbDepartments" Content="Кафедри" GroupName="S" Style="{StaticResource SidebarRadio}" Checked="StructMenu_Checked"/>
                            <RadioButton x:Name="RbDisciplines" Content="Дисципліни" GroupName="S" Style="{StaticResource SidebarRadio}" Checked="StructMenu_Checked"/>
                            <RadioButton x:Name="RbPositions" Content="Посади" GroupName="S" Style="{StaticResource SidebarRadio}" Checked="StructMenu_Checked"/>
                        </StackPanel>
                    </Border>
                    <Grid Grid.Column="1" Margin="20,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock x:Name="TxtStructTitle" Text="Спеціальності" FontSize="20" FontWeight="Bold" Margin="0,0,0,15" Foreground="{StaticResource PrimaryColor}"/>
                        <StackPanel Grid.Row="1" Margin="0,0,0,20">
                            <Grid x:Name="PanelAddSpecialty">
                                <StackPanel Orientation="Horizontal">
                                    <TextBox x:Name="TxtSpecCode" Width="100" Margin="0,0,10,0"/>
                                    <TextBox x:Name="TxtSpecName" Width="300" Margin="0,0,10,0"/>
                                    <Button Content="Додати" Click="BtnAddSpecialty_Click"/>
                                </StackPanel>
                            </Grid>
                            <Grid x:Name="PanelAddGroup" Visibility="Collapsed">
                                <StackPanel Orientation="Horizontal">
                                    <TextBox x:Name="TxtGroupCode" Width="100" Margin="0,0,10,0"/>
                                    <TextBox x:Name="TxtGroupYear" Width="80" Margin="0,0,10,0"/>
                                    <ComboBox x:Name="CmbSpecForGroup" Width="200" DisplayMemberPath="Code" SelectedValuePath="SpecialtyId" Margin="0,0,10,0"/>
                                    <Button Content="Додати" Click="BtnAddGroup_Click"/>
                                </StackPanel>
                            </Grid>
                            <Grid x:Name="PanelAddDept" Visibility="Collapsed">
                                <StackPanel Orientation="Horizontal">
                                    <TextBox x:Name="TxtDeptName" Width="400" Margin="0,0,10,0"/>
                                    <Button Content="Додати" Click="BtnAddDept_Click"/>
                                </StackPanel>
                            </Grid>
                            <Grid x:Name="PanelAddSimple" Visibility="Collapsed">
                                <StackPanel Orientation="Horizontal">
                                    <TextBox x:Name="TxtSimpleName" Width="400" Margin="0,0,10,0"/>
                                    <Button Content="Додати" Click="BtnAddSimple_Click"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                        <Grid Grid.Row="2">
                            <DataGrid x:Name="GridSpecialties" CanUserSortColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Код" Binding="{Binding Code}"/>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTemplateColumn Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Style="{StaticResource IconButton}" Background="#FF9800" Margin="0,0,5,0" Click="BtnEditStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                    <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <DataGrid x:Name="GridGroups" Visibility="Collapsed" CanUserSortColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Шифр" Binding="{Binding GroupCode}"/>
                                    <DataGridTextColumn Header="Рік" Binding="{Binding EntryYear}"/>
                                    <DataGridTextColumn Header="Спец." Binding="{Binding Specialty.Code}" Width="*"/>
                                    <DataGridTemplateColumn Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Style="{StaticResource IconButton}" Background="#FF9800" Margin="0,0,5,0" Click="BtnEditStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                    <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <DataGrid x:Name="GridDepartments" Visibility="Collapsed" CanUserSortColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding DepartmentName}" Width="*"/>
                                    <DataGridTemplateColumn Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Style="{StaticResource IconButton}" Background="#FF9800" Margin="0,0,5,0" Click="BtnEditStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                    <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <DataGrid x:Name="GridSimple" Visibility="Collapsed" CanUserSortColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTemplateColumn Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Style="{StaticResource IconButton}" Background="#FF9800" Margin="0,0,5,0" Click="BtnEditStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconPencil}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                    <Button Style="{StaticResource IconButton}" Background="#F44336" Click="BtnDeleteStruct_Click" Tag="{Binding}">
                                                        <Path Data="{StaticResource IconClose}" Fill="White" Stretch="Uniform" Margin="2"/>
                                                    </Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Бази і Теми">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Border BorderBrush="#EEE" BorderThickness="0,0,1,0" Padding="0,0,20,0">
                        <ScrollViewer>
                            <StackPanel>
                                <TextBlock Text="Створити тему" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                                <TextBlock Text="Назва теми" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtTopicTitle" Margin="0,0,0,10"/>
                                <TextBlock Text="Опис" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtTopicDesc" Height="80" TextWrapping="Wrap" Margin="0,0,0,10"/>
                                <TextBlock Text="База практики" Style="{StaticResource LabelStyle}"/>
                                <ComboBox x:Name="CmbOrganizations" DisplayMemberPath="Name" SelectedValuePath="OrganizationId" Margin="0,0,0,15"/>
                                <Button Content="Опублікувати тему" Click="BtnAddTopic_Click"/>
                                <Separator Margin="0,25"/>
                                <TextBlock Text="Додати організацію" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                                <TextBlock Text="Назва" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtOrgName" Margin="0,0,0,10"/>
                                <TextBlock Text="Адреса" Style="{StaticResource LabelStyle}"/>
                                <TextBox x:Name="TxtOrgAddr" Margin="0,0,0,10"/>
                                <TextBlock Text="Тип" Style="{StaticResource LabelStyle}"/>
                                <ComboBox x:Name="CmbOrgType" Margin="0,0,0,15">
                                    <ComboBoxItem Content="Зовнішня"/>
                                    <ComboBoxItem Content="Кафедра"/>
                                </ComboBox>
                                <Button Content="Додати організацію" Click="BtnAddOrg_Click" Background="#607D8B"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>

                    <Grid Grid.Column="1" Margin="20,0,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox>
                            <GroupBox.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Список тем" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Text="  |  Фільтр по базі:" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="Gray"/>
                                    <ComboBox x:Name="CmbFilterTopicOrg" Width="150" DisplayMemberPath="Name" SelectedValuePath="OrganizationId" SelectionChanged="CmbFilterTopicOrg_SelectionChanged" Height="25" Padding="5,0"/>
                                    <Button Content="X" Width="25" Height="25" Margin="5,0,0,0" Background="#90A4AE" Padding="0" Click="BtnResetTopicFilter_Click" ToolTip="Очистити фільтр"/>
                                </StackPanel>
                            </GroupBox.Header>
                            <DataGrid x:Name="GridTopics" IsReadOnly="True" CanUserSortColumns="True" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding Title}" Width="*"/>
                                    <DataGridTextColumn Header="Організація" Binding="{Binding Organization.Name}" Width="200"/>
                                    <DataGridTemplateColumn Header="Вільна" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsAvailable, Mode=OneWay}" Click="ChkTopicAvailable_Click" HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>

                        <GroupBox Grid.Row="1" Margin="0,15,0,0">
                            <GroupBox.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Список організацій" FontWeight="Bold" VerticalAlignment="Center"/>
                                    <TextBlock Text="  |  Фільтр по типу:" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="Gray"/>
                                    <ComboBox x:Name="CmbFilterOrgType" Width="150" SelectionChanged="CmbFilterOrgType_SelectionChanged" Height="25" Padding="5,0">
                                        <ComboBoxItem Content="Всі"/>
                                        <ComboBoxItem Content="Зовнішня"/>
                                        <ComboBoxItem Content="Кафедра"/>
                                    </ComboBox>
                                    <Button Content="X" Width="25" Height="25" Margin="5,0,0,0" Background="#90A4AE" Padding="0" Click="BtnResetOrgFilter_Click" ToolTip="Очистити фільтр"/>
                                </StackPanel>
                            </GroupBox.Header>
                            <DataGrid x:Name="GridOrgs" IsReadOnly="True" CanUserSortColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Назва" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTextColumn Header="Адреса" Binding="{Binding Address}" Width="*"/>
                                    <DataGridTextColumn Header="Тип" Binding="{Binding Type}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                    </Grid>
                </Grid>
            </TabItem>

            <TabItem Header="Журнал подій">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Button Content="Оновити журнал" HorizontalAlignment="Left" Click="BtnRefreshLogs_Click" Margin="0,0,0,10" Background="#90A4AE"/>
                    <DataGrid Grid.Row="1" x:Name="GridLogs" IsReadOnly="True" CanUserSortColumns="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Дата" Binding="{Binding TimeStamp, StringFormat=\{0:dd.MM.yyyy HH:mm\}}" Width="150"/>
                            <DataGridTextColumn Header="User ID" Binding="{Binding UserId}" Width="80"/>
                            <DataGridTextColumn Header="Дія" Binding="{Binding Action}" Width="150"/>
                            <DataGridTextColumn Header="Деталі" Binding="{Binding Details}" Width="*"/>
                            <DataGridTextColumn Header="Сутність" Binding="{Binding EntityAffected}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <Grid x:Name="ModalEditStudent" Visibility="Collapsed" Background="#7F000000" Grid.RowSpan="2" Panel.ZIndex="100">
            <Border Background="White" Width="400" CornerRadius="8" Padding="20" VerticalAlignment="Center">
                <StackPanel>
                    <TextBlock Text="Редагування студента" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    <TextBlock Text="Прізвище:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditStudLast" Margin="0,0,0,10"/>
                    <TextBlock Text="Ім'я:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditStudFirst" Margin="0,0,0,10"/>
                    <TextBlock Text="Email:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditStudEmail" Margin="0,0,0,10"/>
                    <TextBlock Text="Група:" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="EditStudGroup" DisplayMemberPath="GroupCode" SelectedValuePath="GroupId" Margin="0,0,0,10"/>
                    <TextBlock Text="Залікова книжка:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditStudRecord" Margin="0,0,0,20"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Скасувати" Background="Transparent" Foreground="Gray" Click="BtnCloseModal_Click" Margin="0,0,10,0"/>
                        <Button Content="Зберегти" Click="BtnSaveEditStudent_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        <Grid x:Name="ModalEditSupervisor" Visibility="Collapsed" Background="#7F000000" Grid.RowSpan="2" Panel.ZIndex="100">
            <Border Background="White" Width="400" CornerRadius="8" Padding="20" VerticalAlignment="Center">
                <StackPanel>
                    <TextBlock Text="Редагування керівника" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    <TextBlock Text="Прізвище:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditSupLast" Margin="0,0,0,10"/>
                    <TextBlock Text="Ім'я:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditSupFirst" Margin="0,0,0,10"/>
                    <TextBlock Text="Email:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditSupEmail" Margin="0,0,0,10"/>
                    <TextBlock Text="Кафедра:" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="EditSupDept" DisplayMemberPath="DepartmentName" SelectedValuePath="DepartmentId" Margin="0,0,0,10"/>
                    <TextBlock Text="Посада:" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="EditSupPos" DisplayMemberPath="PositionName" SelectedValuePath="PositionId" Margin="0,0,0,10"/>
                    <TextBlock Text="Телефон:" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="EditSupPhone" Margin="0,0,0,20"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Скасувати" Background="Transparent" Foreground="Gray" Click="BtnCloseModal_Click" Margin="0,0,10,0"/>
                        <Button Content="Зберегти" Click="BtnSaveEditSupervisor_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        <Grid x:Name="ModalEditStruct" Visibility="Collapsed" Background="#7F000000" Grid.RowSpan="2" Panel.ZIndex="100">
            <Border Background="White" Width="350" CornerRadius="8" Padding="20" VerticalAlignment="Center">
                <StackPanel>
                    <TextBlock Text="Редагування" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    <StackPanel x:Name="PanelEditStructName">
                        <TextBlock x:Name="LblStructName" Text="Назва:" Style="{StaticResource LabelStyle}"/>
                        <TextBox x:Name="EditStructName" Margin="0,0,0,15"/>
                    </StackPanel>
                    <StackPanel x:Name="PanelEditStructCode" Visibility="Collapsed">
                        <TextBlock x:Name="LblStructCode" Text="Код / Шифр:" Style="{StaticResource LabelStyle}"/>
                        <TextBox x:Name="EditStructCode" Margin="0,0,0,15"/>
                    </StackPanel>
                    <StackPanel x:Name="PanelEditStructYear" Visibility="Collapsed">
                        <TextBlock Text="Рік вступу:" Style="{StaticResource LabelStyle}"/>
                        <TextBox x:Name="EditStructYear" Margin="0,0,0,15"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Скасувати" Background="Transparent" Foreground="Gray" Click="BtnCloseModal_Click" Margin="0,0,10,0"/>
                        <Button Content="Зберегти" Click="BtnSaveEditStruct_Click"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

    </Grid>
</Window>